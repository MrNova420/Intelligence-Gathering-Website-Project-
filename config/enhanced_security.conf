# Enhanced Security Configuration for Intelligence Gathering Platform
# Comprehensive security settings for production deployment

# ============================================================================
# AUTHENTICATION & ACCESS CONTROL
# ============================================================================

# JWT Configuration
JWT_ALGORITHM=HS256
JWT_ACCESS_TOKEN_EXPIRE_MINUTES=30
JWT_REFRESH_TOKEN_EXPIRE_DAYS=7
JWT_SECRET_KEY_ROTATION_DAYS=90

# Password Policies
PASSWORD_MIN_LENGTH=12
PASSWORD_REQUIRE_UPPERCASE=true
PASSWORD_REQUIRE_LOWERCASE=true
PASSWORD_REQUIRE_NUMBERS=true
PASSWORD_REQUIRE_SPECIAL_CHARS=true
PASSWORD_HISTORY_COUNT=5
PASSWORD_EXPIRY_DAYS=90

# Multi-Factor Authentication
MFA_ENABLED=true
MFA_BACKUP_CODES_COUNT=10
MFA_TOTP_WINDOW=1
MFA_GRACE_PERIOD_HOURS=24

# Account Security
ACCOUNT_LOCKOUT_ATTEMPTS=5
ACCOUNT_LOCKOUT_DURATION_MINUTES=30
SESSION_TIMEOUT_MINUTES=60
CONCURRENT_SESSIONS_LIMIT=3

# API Key Security
API_KEY_LENGTH=64
API_KEY_EXPIRY_DAYS=365
API_KEY_RATE_LIMIT_PER_HOUR=1000

# ============================================================================
# NETWORK SECURITY
# ============================================================================

# CORS Configuration
CORS_ALLOWED_ORIGINS=["https://yourdomain.com", "https://www.yourdomain.com"]
CORS_ALLOW_CREDENTIALS=true
CORS_MAX_AGE=86400
CORS_ALLOW_METHODS=["GET", "POST", "PUT", "DELETE", "OPTIONS"]
CORS_ALLOW_HEADERS=["Authorization", "Content-Type", "X-Requested-With"]

# Content Security Policy
CSP_DEFAULT_SRC='self'
CSP_SCRIPT_SRC='self' 'unsafe-inline' 'unsafe-eval' https://cdn.jsdelivr.net
CSP_STYLE_SRC='self' 'unsafe-inline' https://fonts.googleapis.com
CSP_FONT_SRC='self' https://fonts.gstatic.com
CSP_IMG_SRC='self' data: https: blob:
CSP_CONNECT_SRC='self' https://api.stripe.com
CSP_FRAME_ANCESTORS='none'
CSP_BASE_URI='self'
CSP_FORM_ACTION='self'

# Security Headers
SECURITY_HEADERS_ENABLED=true
HSTS_MAX_AGE=31536000
HSTS_INCLUDE_SUBDOMAINS=true
HSTS_PRELOAD=true
X_FRAME_OPTIONS=DENY
X_CONTENT_TYPE_OPTIONS=nosniff
X_XSS_PROTECTION=1; mode=block
REFERRER_POLICY=strict-origin-when-cross-origin
PERMISSIONS_POLICY=camera=(), microphone=(), geolocation=(), payment=()

# SSL/TLS Configuration
SSL_PROTOCOLS=TLSv1.2,TLSv1.3
SSL_CIPHERS=ECDHE-ECDSA-AES256-GCM-SHA384:ECDHE-RSA-AES256-GCM-SHA384
SSL_PREFER_SERVER_CIPHERS=on
SSL_SESSION_CACHE=shared:SSL:10m
SSL_SESSION_TIMEOUT=10m
SSL_STAPLING=on
SSL_STAPLING_VERIFY=on

# ============================================================================
# RATE LIMITING & DDoS PROTECTION
# ============================================================================

# Global Rate Limiting
RATE_LIMIT_ENABLED=true
RATE_LIMIT_REQUESTS_PER_MINUTE=60
RATE_LIMIT_REQUESTS_PER_HOUR=1000
RATE_LIMIT_REQUESTS_PER_DAY=10000
RATE_LIMIT_BURST=10

# Endpoint-Specific Rate Limits
RATE_LIMIT_LOGIN_PER_MINUTE=5
RATE_LIMIT_REGISTER_PER_HOUR=10
RATE_LIMIT_PASSWORD_RESET_PER_HOUR=5
RATE_LIMIT_API_CALLS_PER_MINUTE=100
RATE_LIMIT_SEARCH_PER_MINUTE=20

# IP-Based Protection
IP_WHITELIST_ENABLED=false
IP_WHITELIST=[]
IP_BLACKLIST_ENABLED=true
IP_BLACKLIST=[]
AUTO_IP_BLOCKING_ENABLED=true
AUTO_IP_BLOCKING_THRESHOLD=100
AUTO_IP_BLOCKING_DURATION_HOURS=24

# Geographic Restrictions
GEO_BLOCKING_ENABLED=false
GEO_ALLOWED_COUNTRIES=[]
GEO_BLOCKED_COUNTRIES=[]

# ============================================================================
# DATA PROTECTION & ENCRYPTION
# ============================================================================

# Encryption Configuration
ENCRYPTION_ALGORITHM=AES-256-GCM
ENCRYPTION_KEY_DERIVATION=PBKDF2
ENCRYPTION_KEY_ITERATIONS=100000
ENCRYPTION_SALT_LENGTH=32

# Database Encryption
DATABASE_ENCRYPTION_ENABLED=true
DATABASE_BACKUP_ENCRYPTION=true
DATABASE_CONNECTION_SSL=require

# File Upload Security
FILE_UPLOAD_MAX_SIZE_MB=10
FILE_UPLOAD_ALLOWED_EXTENSIONS=jpg,jpeg,png,gif,pdf,txt,csv,docx,xlsx
FILE_UPLOAD_SCAN_VIRUSES=true
FILE_UPLOAD_QUARANTINE_SUSPICIOUS=true

# Data Retention
DATA_RETENTION_ENABLED=true
USER_DATA_RETENTION_DAYS=2555  # 7 years
LOG_DATA_RETENTION_DAYS=365
SESSION_DATA_RETENTION_DAYS=30
TEMPORARY_FILE_RETENTION_HOURS=24

# ============================================================================
# MONITORING & LOGGING
# ============================================================================

# Security Logging
SECURITY_LOGGING_ENABLED=true
SECURITY_LOG_LEVEL=INFO
SECURITY_LOG_FILE=/var/log/intelligence-platform/security.log
SECURITY_LOG_MAX_SIZE_MB=100
SECURITY_LOG_ROTATION_COUNT=10

# Audit Logging
AUDIT_LOGGING_ENABLED=true
AUDIT_LOG_LEVEL=INFO
AUDIT_LOG_FILE=/var/log/intelligence-platform/audit.log
AUDIT_LOG_SENSITIVE_DATA=false
AUDIT_LOG_RETENTION_DAYS=2555

# Intrusion Detection
IDS_ENABLED=true
IDS_SUSPICIOUS_ACTIVITY_THRESHOLD=10
IDS_ALERT_EMAIL=security@yourdomain.com
IDS_WEBHOOK_URL=
IDS_CHECK_INTERVAL_MINUTES=5

# Failed Authentication Monitoring
FAILED_AUTH_MONITORING=true
FAILED_AUTH_THRESHOLD_PER_IP=10
FAILED_AUTH_THRESHOLD_PER_USER=5
FAILED_AUTH_TIME_WINDOW_MINUTES=15
FAILED_AUTH_NOTIFICATION=true

# ============================================================================
# COMPLIANCE & PRIVACY
# ============================================================================

# GDPR Compliance
GDPR_COMPLIANCE_ENABLED=true
GDPR_DATA_PORTABILITY=true
GDPR_RIGHT_TO_ERASURE=true
GDPR_CONSENT_REQUIRED=true
GDPR_COOKIE_CONSENT=true
GDPR_DATA_PROCESSOR_AGREEMENT=true

# Privacy Settings
PRIVACY_DATA_MINIMIZATION=true
PRIVACY_ANONYMOUS_ANALYTICS=true
PRIVACY_COOKIE_SECURE=true
PRIVACY_COOKIE_HTTPONLY=true
PRIVACY_COOKIE_SAMESITE=Strict

# Data Subject Rights
DATA_SUBJECT_ACCESS_REQUEST=true
DATA_SUBJECT_RECTIFICATION=true
DATA_SUBJECT_PORTABILITY=true
DATA_SUBJECT_ERASURE=true
DATA_SUBJECT_PROCESSING_RESTRICTION=true

# ============================================================================
# BACKUP & DISASTER RECOVERY
# ============================================================================

# Backup Security
BACKUP_ENCRYPTION_ENABLED=true
BACKUP_ENCRYPTION_KEY_ROTATION=true
BACKUP_INTEGRITY_CHECKING=true
BACKUP_ACCESS_LOGGING=true

# Disaster Recovery
DR_AUTOMATED_BACKUPS=true
DR_BACKUP_FREQUENCY_HOURS=4
DR_BACKUP_RETENTION_DAYS=90
DR_OFFSITE_BACKUP=true
DR_BACKUP_TESTING_FREQUENCY_DAYS=30

# ============================================================================
# INCIDENT RESPONSE
# ============================================================================

# Incident Detection
INCIDENT_DETECTION_ENABLED=true
INCIDENT_AUTO_RESPONSE=true
INCIDENT_NOTIFICATION_EMAIL=security@yourdomain.com
INCIDENT_ESCALATION_THRESHOLD=CRITICAL

# Security Incident Types
INCIDENT_TYPES=["unauthorized_access", "data_breach", "malware", "ddos", "privilege_escalation"]

# Response Actions
INCIDENT_AUTO_BLOCK_IP=true
INCIDENT_AUTO_DISABLE_USER=true
INCIDENT_AUTO_ISOLATE_SYSTEM=false
INCIDENT_FORENSIC_LOGGING=true

# ============================================================================
# THIRD-PARTY INTEGRATIONS
# ============================================================================

# Security Services
SECURITY_SCANNING_ENABLED=true
VULNERABILITY_SCANNING_URL=
MALWARE_SCANNING_API_KEY=
THREAT_INTELLIGENCE_FEED_URL=

# External Security Tools
SIEM_INTEGRATION_ENABLED=false
SIEM_ENDPOINT=
SIEM_API_KEY=
SOC_WEBHOOK_URL=

# Security APIs
VIRUS_TOTAL_API_KEY=
HYBRID_ANALYSIS_API_KEY=
SHODAN_API_KEY=
CENSYS_API_KEY=

# ============================================================================
# DEVELOPMENT & TESTING
# ============================================================================

# Development Security
DEVELOPMENT_MODE=false
DEBUG_MODE=false
TESTING_MODE=false
SECURITY_TESTING_ENABLED=true

# Security Testing
PENETRATION_TESTING_SCHEDULE=monthly
VULNERABILITY_ASSESSMENT_SCHEDULE=weekly
SECURITY_CODE_REVIEW=true
DEPENDENCY_SCANNING=true

# ============================================================================
# ADVANCED FEATURES
# ============================================================================

# AI-Powered Security
AI_ANOMALY_DETECTION=true
AI_THREAT_ANALYSIS=true
AI_BEHAVIORAL_ANALYSIS=true
AI_RISK_SCORING=true

# Zero Trust Architecture
ZERO_TRUST_ENABLED=true
ZERO_TRUST_NETWORK_SEGMENTATION=true
ZERO_TRUST_DEVICE_VERIFICATION=true
ZERO_TRUST_USER_VERIFICATION=continuous

# Advanced Threat Protection
ATP_ENABLED=true
ATP_SANDBOX_ANALYSIS=true
ATP_REPUTATION_CHECKING=true
ATP_MACHINE_LEARNING=true

# ============================================================================
# CUSTOM SECURITY RULES
# ============================================================================

# Custom Rules Engine
CUSTOM_RULES_ENABLED=true
CUSTOM_RULES_FILE=/etc/intelligence-platform/security-rules.json
CUSTOM_RULES_RELOAD_INTERVAL_MINUTES=5

# Security Automation
SECURITY_AUTOMATION_ENABLED=true
SECURITY_ORCHESTRATION=true
SECURITY_PLAYBOOKS_ENABLED=true

# ============================================================================
# ENVIRONMENT-SPECIFIC OVERRIDES
# ============================================================================

# Production Overrides
[production]
DEBUG_MODE=false
SECURITY_LOG_LEVEL=WARNING
RATE_LIMIT_STRICT=true
MFA_REQUIRED=true

# Staging Overrides
[staging]
DEBUG_MODE=false
SECURITY_LOG_LEVEL=INFO
RATE_LIMIT_RELAXED=true
MFA_OPTIONAL=true

# Development Overrides (DO NOT USE IN PRODUCTION)
[development]
DEBUG_MODE=true
SECURITY_LOG_LEVEL=DEBUG
RATE_LIMIT_DISABLED=false
MFA_DISABLED=false